
아바타 이미지를 렌더링하다가 아래와 같은 경고와 타입 오류를 마주했습니다.  

```
An empty string ("") was passed to the src attribute. This may cause the browser to download the whole page again over the network. 
To fix this, either do not render the element at all or pass null to src instead of an empty string.
```
---

## ❗ 문제 상황

React에서 다음과 같이 아바타 이미지를 렌더링했습니다.
```tsx
<UserAvatar src={project?.manager?.profileImage} />
```
`UserAvatar` 컴포넌트는 이렇게 생겼습니다.
```tsx
export const UserAvatar = ({
  src = "",
  alt = "사용자",
}: UserAvatarProps) => {
  return (
    <Avatar>
      <AvatarImage src={src} alt={alt} />
      <AvatarFallback>...</AvatarFallback>
    </Avatar>
  );
};
```
여기서 `src` 기본값을 빈 문자열("")로 주었습니다.
문제는 `project?.manager?.profileImage`가 `null`일 경우에도 `src=""`가 그대로 넘어간다는 점입니다.

## 🧩 원인

`src=""`는 브라우저에서 **"빈 상대 경로"**로 인식됩니다.

- 현재 페이지: `https://example.com/dashboard`
- `src=""` → 브라우저는 `https://example.com/dashboard`로 요청

즉, **현재 페이지를 다시 다운로드**하게 됩니다.

반면, React에서 `undefined`나 `null`을 주면:

```tsx
<img src={undefined} />
// 실제 HTML: <img>
```
- `src` 속성이 아예 없어서 브라우저가 요청할 리소스가 없습니다.
- 불필요한 네트워크 요청이 발생하지 않습니다.

## ✅ 해결 방법
`src` 기본값을 빈 문자열이 아닌 `undefined`나 `null`로 변경했습니다.
```tsx
export const UserAvatar = ({
  src,
  alt = "사용자",
  className = "",
  size = "md",
  color = "default",
}: UserAvatarProps) => {
  return (
    <Avatar className={clsx(sizeClasses[size], className)}>
      <AvatarImage src={src ?? undefined} alt={alt} />
      <AvatarFallback>
        <IoPersonCircle
          className={clsx(sizeClasses[size], colorClasses[color])}
        />
      </AvatarFallback>
    </Avatar>
  );
};
```
- `src` → `null`이나 `undefined`일 때 `src` 속성이 아예 빠집니다.
- 이미지 경로가 없을 때 브라우저 경고가 사라집니다.

## 🤔 왜 `src=""`면 브라우저가 현재 페이지를 다시 요청할까?

### 1. HTML img 태그에서 src 속성은 URL입니다.
- 만약 `src`가 빈 문자열("")이면, HTML 표준에 따라 브라우저는 이것을 **현재 문서의 URL**로 해석합니다.  
- 예: 현재 주소가 `https://example.com/dashboard`라면  
  `src=""` → 브라우저는 `https://example.com/dashboard`를 다시 요청

### 2. 상대 경로 규칙
- `src`에 값이 없으면 **"빈 상대 경로"**로 간주됩니다.  
- 상대 경로 기준(base URL)은 현재 페이지 URL이므로, 브라우저는 현재 페이지를 다시 네트워크 요청으로 불러옵니다.

### 3. 왜 `undefined`나 `null`은 괜찮을까?
- React에서 `src={undefined}`나 `src={null}`을 주면, 렌더링 시 `src` 속성이 DOM에 아예 생성되지 않습니다.

```tsx
<img src={undefined} />
// 실제 HTML: <img>
```
속성이 없으니 브라우저는 요청할 대상이 없고, 불필요한 네트워크 요청이 발생하지 않습니다.

## 🆚 상대경로 vs 절대경로
페이지 URL: https://example.com/dashboard
### 1️⃣ 상대경로 (현재 페이지 기준)

| src 값             | 브라우저 요청 URL                                | 설명                   |
| ----------------- | ------------------------------------------ | -------------------- |
| `"avatar.jpg"`    | `https://example.com/dashboard/avatar.jpg` | 현재 페이지 폴더 기준         |
| `"./avatar.jpg"`  | `https://example.com/dashboard/avatar.jpg` | 현재 페이지 폴더 기준         |
| `"../avatar.jpg"` | `https://example.com/avatar.jpg`           | 상위 폴더 기준             |
| `""`              | `https://example.com/dashboard`            | 빈 문자열 → 현재 페이지 다시 요청 |

### 2️⃣ 절대경로

- 루트 기준 절대경로: /로 시작

| src 값                                     | 브라우저 요청 URL                             | 설명                 |
| ----------------------------------------- | --------------------------------------- | ------------------ |
| `"/images/avatar.jpg"`                    | `https://example.com/images/avatar.jpg` | 도메인 기준 최상위 경로      |
| `"https://example.com/images/avatar.jpg"` | `https://example.com/images/avatar.jpg` | 전체 URL 지정 (도메인 포함) |




## 🔄 흐름도
### 기존 코드
project?.manager?.profileImage
       ↓
     null?
      ├── Yes → src = "" → 브라우저가 현재 페이지 URL 요청 → 경고 발생
      └── No  → src = "https://example.com/avatar.jpg" → 이미지 정상 요청

### 변경후 코드 
project?.manager?.profileImage
       ↓
     null?
      ├── Yes → src = undefined → img 태그에 src 없음 → 브라우저 요청 없음
      └── No  → src = "https://example.com/avatar.jpg" → 이미지 정상 요청
      
| 값                  | 브라우저 동작                  |
| ------------------ | ------------------------ |
| `""`               | 현재 페이지 URL 다시 요청 → 경고 발생 |
| `undefined / null` | `src` 속성 없음 → 요청 없음      |
      
        

## 📝 정리
이미지 경로가 없을 때 **빈 문자열("")을 `src`에 넣으면 안 됩니다.**  
HTML 표준에 따라 빈 문자열은 현재 페이지를 다시 요청하게 되어, 불필요한 네트워크 요청과 브라우저 경고를 유발합니다.  

이번 경험을 통해, 단순히 기본값을 빈 문자열로 두는 것만으로도 예기치 않은 문제가 발생할 수 있다는 것을 배웠습니다.  
앞으로는 이미지 경로가 없을 때 **`undefined`나 `null`**을 사용할 계획입니다.
