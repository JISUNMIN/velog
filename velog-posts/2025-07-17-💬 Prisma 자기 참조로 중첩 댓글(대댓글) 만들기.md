ëŒ€ëŒ“ê¸€ ê¸°ëŠ¥ì„ êµ¬í˜„í•˜ëŠ” ê³¼ì •ì—ì„œ ìì—°ìŠ¤ëŸ½ê²Œ **ìê¸° ì°¸ì¡°(self-relation)**ë¼ëŠ” ê°œë…ì„ ì ‘í•˜ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.
ëŒ“ê¸€ì„ ì§ì ‘ êµ¬í˜„í•´ë³¸ ì ì´ ì—†ì–´ì„œ ë‹¤ì†Œ ìƒì†Œí•œ ê°œë…ì´ì—ˆê³ , ì˜ˆì „ì— MySQLì—ì„œ ë¹„ìŠ·í•œ ê°œë…ì„ ì¨ë³¸ ê²ƒ ê°™ê¸°ë„ í•˜ê³  ì•„ë‹Œ ê²ƒ ê°™ê¸°ë„ í•´ì„œ ì •í™•íˆ ê¸°ì–µë‚˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ğŸ¤”
ê·¸ë˜ì„œ ì´ë²ˆì— ë‹¤ì‹œ í•œ ë²ˆ ê¼¼ê¼¼íˆ ì•Œì•„ë³´ë©´ì„œ ì •ë¦¬í•´ ë³´ì•˜ìŠµë‹ˆë‹¤.
ì´ë²ˆ ê¸€ì—ì„œëŠ” ì´ ìê¸° ì°¸ì¡° ê°œë…ì„ ê¸°ë°˜ìœ¼ë¡œ Prismaì—ì„œ ëŒ€ëŒ“ê¸€ ê¸°ëŠ¥ì„ êµ¬í˜„í•˜ëŠ” ë°©ë²•ì„ ì„¤ëª…í•©ë‹ˆë‹¤.

---

## âœ… ìê¸° ì°¸ì¡°(self-relation)ë€?
**ìê¸° ì°¸ì¡° ê´€ê³„**ë€, í•˜ë‚˜ì˜ ëª¨ë¸ì´ **ìê¸° ìì‹ ê³¼ ê°™ì€ ëª¨ë¸ì˜ ë‹¤ë¥¸ ì¸ìŠ¤í„´ìŠ¤**ë¥¼ ì°¸ì¡°í•˜ëŠ” ê´€ê³„ë¥¼ ë§í•©ë‹ˆë‹¤.  
ì¦‰, **ê°™ì€ í…Œì´ë¸” ì•ˆì˜ ë‹¤ë¥¸ ë ˆì½”ë“œ**ë¥¼ ì°¸ì¡°í•˜ëŠ” êµ¬ì¡°ì…ë‹ˆë‹¤.

## ğŸ“ í´ë” êµ¬ì¡° ì˜ˆì‹œë¡œ ì´í•´í•˜ê¸°

ì˜ˆë¥¼ ë“¤ì–´, í´ë” êµ¬ì¡°ëŠ” ì•„ë˜ì²˜ëŸ¼ ê³„ì¸µ êµ¬ì¡°ë¥¼ ê°€ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤:

ğŸ“ í´ë”
â”œâ”€â”€ id: 1, name: "A", parentFolderId: null
â”œâ”€â”€ id: 2, name: "B", parentFolderId: 1
â”œâ”€â”€ id: 3, name: "C", parentFolderId: 2


- í´ë” BëŠ” `parentFolderId = 1` â†’ í´ë” Aë¥¼ ë¶€ëª¨ë¡œ ì°¸ì¡°
- í´ë” CëŠ” `parentFolderId = 2` â†’ í´ë” Bë¥¼ ë¶€ëª¨ë¡œ ì°¸ì¡°

ì¦‰,  **ìê¸° ìì‹ (ëª¨ë¸)ì„ ì°¸ì¡°**í•¨ìœ¼ë¡œì¨ **íŠ¸ë¦¬ í˜•íƒœì˜ êµ¬ì¡°**ë¥¼ í‘œí˜„í•˜ê³  ìˆëŠ” ê²ƒì…ë‹ˆë‹¤.

ì´ê±¸ ë°ì´í„°ë² ì´ìŠ¤ì—ì„œëŠ” **ìê¸° ì°¸ì¡° ê´€ê³„(self-relation)** ë¼ê³  í•©ë‹ˆë‹¤.

  > íŠ¸ë¦¬í˜• êµ¬ì¡°: í•˜ë‚˜ì˜ **ë£¨íŠ¸(root)**ì—ì„œ ì‹œì‘í•´ì„œ
ê·¸ ì•„ë˜ì— ì—¬ëŸ¬ ê°œì˜ **ìì‹ ë…¸ë“œ(children)**ê°€ ì´ì–´ì§€ëŠ” êµ¬ì¡°
>ğŸ’¬ ëŒ“ê¸€ ì˜ˆì‹œë¡œ ë³´ë©´:
ëŒ“ê¸€ A
â”— ëŒ€ëŒ“ê¸€ A-1
â”ƒ â”— ëŒ€ëŒ“ê¸€ A-1-1
â”ƒ â”— ëŒ€ëŒ“ê¸€ A-1-1-1
â”— ëŒ€ëŒ“ê¸€ A-2


## âŒ ê¸°ì¡´ êµ¬ì¡°: ëŒ€ëŒ“ê¸€ ë¶ˆê°€ëŠ¥í•œ Comment ëª¨ë¸  
```ts
model Comment {
  id      Int    @id @default(autoincrement())
  comment String
  userId  Int
  taskId  Int

  user User @relation(fields: [userId], references: [id])
  task Task @relation(fields: [taskId], references: [id], onDelete: Cascade)
}

```

### âš ï¸ ë¬¸ì œì 

- **ëŒ“ê¸€ ì—¬ëŸ¬ ê°œ**: âœ… ê°€ëŠ¥  
  í•˜ë‚˜ì˜ Taskì— ì—¬ëŸ¬ ê°œ ëŒ“ê¸€ ì‘ì„± ê°€ëŠ¥

- **ëŒ€ëŒ“ê¸€ ê¸°ëŠ¥**: âŒ ë¶ˆê°€ëŠ¥  
  `Comment`ê°€ ë‹¤ë¥¸ `Comment`ë¥¼ ì°¸ì¡°í•˜ì§€ ì•Šê¸° ë•Œë¬¸ì— ëŒ€ëŒ“ê¸€ êµ¬ì¡°ë¥¼ ë§Œë“¤ ìˆ˜ ì—†ìŒ

- **êµ¬ì¡° í˜•íƒœ**: ğŸ”¹ ë‚©ì‘(flat)í•œ êµ¬ì¡°  
  ê°œë³„ ëŒ“ê¸€ë“¤ì´ ë‚˜ì—´ë  ë¿, ëŒ“ê¸€ ê°„ ê³„ì¸µ ê´€ê³„ë¥¼ í‘œí˜„í•  ìˆ˜ ì—†ìŒ

## ğŸ” ê°œì„ ëœ êµ¬ì¡°: ìê¸° ì°¸ì¡°ë¥¼ ì´ìš©í•œ ëŒ€ëŒ“ê¸€ ê°€ëŠ¥ ëª¨ë¸

```ts
model Comment {
  id              Int       @id @default(autoincrement())
  comment         String
  userId          Int
  taskId          Int
  parentCommentId Int?     // ë¶€ëª¨ ëŒ“ê¸€ ID (nullable)

  user            User      @relation(fields: [userId], references: [id])
  task            Task      @relation(fields: [taskId], references: [id], onDelete: Cascade)

  parentComment   Comment?  @relation("CommentToReplies", fields: [parentCommentId], references: [id])
  replies         Comment[] @relation("CommentToReplies")
}
```

### ğŸ”  ì„¤ëª…
- parentCommentId: ë¶€ëª¨ ëŒ“ê¸€ ID (ì—†ìœ¼ë©´ ì¼ë°˜ ëŒ“ê¸€ ìˆìœ¼ë©´ ëŒ€ëŒ“ê¸€)
- parentComment: ì´ ëŒ“ê¸€ì˜ ë¶€ëª¨ ëŒ“ê¸€ ê°ì²´
- replies: ì´ ëŒ“ê¸€ì— ë‹¬ë¦° ëŒ€ëŒ“ê¸€ ë¦¬ìŠ¤íŠ¸


## ëŒ€ëŒ“ê¸€ êµ¬ì¡° ì˜ˆì‹œ

| id | comment    | parentCommentId |
| -- | ---------- | --------------- |
| 1  | ì˜¤ëŠ˜ê¹Œì§€ í• ê²Œìš”   | `null`          |
| 2  | ë„µ ê°ì‚¬í•©ë‹ˆë‹¤!   | `1`             |
| 3  | ìˆ˜ì • ì¢€ ë¶€íƒë“œë ¤ìš” | `1`             |
| 4  | ë„¤, ìˆ˜ì •í–ˆìŠµë‹ˆë‹¤  | `3`             |

### ğŸ“ êµ¬ì¡° ì‹œê°í™”

ëŒ“ê¸€ 1: ì˜¤ëŠ˜ê¹Œì§€ í• ê²Œìš”
â”œâ”€ ëŒ“ê¸€ 2: ë„µ ê°ì‚¬í•©ë‹ˆë‹¤!
â””â”€ ëŒ“ê¸€ 3: ìˆ˜ì • ì¢€ ë¶€íƒë“œë ¤ìš”
    â””â”€ ëŒ“ê¸€ 4: ë„¤, ìˆ˜ì •í–ˆìŠµë‹ˆë‹¤
    
### ëŒ€ëŒ“ê¸€ í¬í•¨ ëŒ“ê¸€ ë°ì´í„° ì˜ˆì‹œ
```ts
[
  {
    "id": 1,
    "name": "a",
    "parentCommentId": null,
    "parentComment": null,
    "replies": [
      {
        "id": 2,
        "name": "b",
        "parentCommentId": 1,
        "parentComment": {
          "id": 1,
          "name": "a",
          "parentCommentId": null
        },
        "replies": [
          {
            "id": 4,
            "name": "d",
            "parentCommentId": 2,
            "parentComment": {
              "id": 2,
              "name": "b",
              "parentCommentId": 1
            },
            "replies": []
          }
        ]
      },
      {
        "id": 3,
        "name": "c",
        "parentCommentId": 1,
        "parentComment": {
          "id": 1,
          "name": "a",
          "parentCommentId": null
        },
        "replies": []
      }
    ]
  },
  {
    "id": 5,
    "name": "e",
    "parentCommentId": null,
    "parentComment": null,
    "replies": []
  }
]


```




## âœ… ìš”ì•½ ì •ë¦¬

- **ìê¸° ì°¸ì¡°ë€?**  
  ê°™ì€ ëª¨ë¸ ì•ˆì—ì„œ ë‹¤ë¥¸ ë ˆì½”ë“œë¥¼ ì°¸ì¡°í•˜ëŠ” ê´€ê³„ë¥¼ ì˜ë¯¸í•©ë‹ˆë‹¤.

- **ëŒ€ëŒ“ê¸€ êµ¬í˜„ì— ì™œ í•„ìš”í• ê¹Œ?**  
  `Comment`ê°€ ë‹¤ë¥¸ `Comment`ë¥¼ ì°¸ì¡°í•´ì•¼ ëŒ€ëŒ“ê¸€ êµ¬ì¡°ë¥¼ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

- **êµ¬í˜„ ë°©ë²•**  
  `parentCommentId`, `parentComment`, `replies` ê°™ì€ í•„ë“œë¥¼ ëª¨ë¸ì— ì¶”ê°€í•˜ì—¬ ìê¸° ì°¸ì¡° ê´€ê³„ë¥¼ ì„¤ì •í•©ë‹ˆë‹¤.

- **ê²°ê³¼**  
  ì´ êµ¬ì¡°ë¥¼ í†µí•´ ë¬´ì œí•œ ê¹Šì´ì˜ íŠ¸ë¦¬í˜• ëŒ“ê¸€ êµ¬ì¡°ë¥¼ êµ¬í˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
  