Next.jsλ΅ ν”„λ΅μ νΈλ¥Ό κ°λ°ν•λ μ¤‘, νΉμ • μ»΄ν¬λ„νΈμ—μ„ λ‹¤μκ³Ό κ°™μ€ μ—λ¬κ°€ λ°μƒν–μµλ‹λ‹¤.
μ»΄ν¬λ„νΈ λ‚΄λ¶€μ—μ„ useMediaQuery ν›…μ„ μ‚¬μ©ν•΄ ν™”λ©΄ ν¬κΈ°μ— λ”°λΌ μ¤νƒ€μΌμ„ λ‹¤λ¥΄κ² μ μ©ν•λ” μ½”λ“λ¥Ό μ‘μ„±ν–μµλ‹λ‹¤.

---

## β— μ—λ¬ μ½”λ“
```tsx
const isMobile = useMediaQuery("(max-width: 767px)");

return (
  <div
    style={{
      width: isMobile ? "100%" : `${panelWidth}px`,
    }}
  >
    {/* ... */}
  </div>
);
```
μ΄ μ½”λ“λ” μ„λ²„μ—μ„ λ λ”λ§λ  λ• window κ°μ²΄κ°€ μ—†κΈ° λ•λ¬Έμ— μ—λ¬κ°€ λ°μƒν•λ” μ›μΈμ΄ λμ—μµλ‹λ‹¤.

## μ›μΈ 

μ΄ μ—λ¬λ” λ³΄ν†µ SSR(μ„λ²„ μ‚¬μ΄λ“ λ λ”λ§) μ‹ μ„λ²„μ—μ„ λ λ”λ§λ HTMLκ³Ό ν΄λΌμ΄μ–ΈνΈμ—μ„ λ λ”λ§λ HTMLμ΄ λ¶μΌμΉν•  λ• λ°μƒν•©λ‹λ‹¤.  
μ—λ¬ λ©”μ‹μ§€μ— ννΈκ°€ λ‚μ™€ μμµλ‹λ‹¤.  
This can happen if a SSR-ed Client Component used:

- `typeof window !== 'undefined'`
- `Date.now()` or `Math.random()`
- User's locale date formatting
- External changing data without snapshot
- Invalid HTML nesting

μ¦‰, ν΄λΌμ΄μ–ΈνΈ μ „μ© λ΅μ§(window, document, useMediaQuery λ“±)μ„ ν¬ν•¨ν• μ»΄ν¬λ„νΈλ¥Ό SSRλ΅ λ λ”λ§ν•λ ¤κ³  ν•λ©΄ HTML mismatchκ°€ λ°μƒν•  μ μμµλ‹λ‹¤.

## λ¬Έμ  μƒν™© 

λ¬Έμ κ°€ λ°μƒν• μ½”λ“μ μ΄κΈ° importλ” λ‹¤μκ³Ό κ°™μ•μµλ‹λ‹¤:

```ts
import TaskInfoPanel from "../panel/TaskInfoPanel";
```
TaskInfoPanel λ‚΄λ¶€μ—μ„λ” λΈλΌμ°μ € μ „μ© ν›…(useMediaQuery)μ΄λ‚ DOM κ΄€λ ¨ κ°μ²΄(window, ResizeObserver λ“±)λ¥Ό μ‚¬μ©ν•κ³  μμ—κΈ° λ•λ¬Έμ—, μ΄ μƒνƒλ΅λ” SSRμ— μ ν•©ν•μ§€ μ•μ•μµλ‹λ‹¤.


## β… ν•΄κ²° λ°©λ²• 1: `next/dynamic` + `ssr: false`

ν•΄λ‹Ή μ»΄ν¬λ„νΈλ¥Ό ν΄λΌμ΄μ–ΈνΈ μ‚¬μ΄λ“μ—μ„λ§ λ λ”λ§ν•λ„λ΅ `next/dynamic`μ„ μ‚¬μ©ν•΄ dynamic importλ΅ λ³€κ²½ν•©λ‹λ‹¤.

```ts
import dynamic from "next/dynamic";

const TaskInfoPanel = dynamic(
  () => import("@/app/(authenticated)/dashboard/kanban/panel/TaskInfoPanel"),
  {
    ssr: false,
  }
);
```

### π”§ μ΄λ ‡κ² μ„¤μ •ν•λ©΄?
- TaskInfoPanelμ€ μ„λ²„μ—μ„ λ λ”λ§λμ§€ μ•κ³ , λΈλΌμ°μ €μ—μ„λ§ λ λ”λ§λ©λ‹λ‹¤.
- λ”°λΌμ„ window κ°μ²΄ λ“± λΈλΌμ°μ € μ „μ© APIλ¥Ό μ•μ „ν•κ² μ‚¬μ©ν•  μ μμµλ‹λ‹¤.
- hydration mismatch λ¬Έμ λ„ ν•΄κ²°λ©λ‹λ‹¤.

## β… ν•΄κ²° λ°©λ²• 2: "use client" μ‚¬μ©

μ»΄ν¬λ„νΈ νμΌ μƒλ‹¨μ— "use client"λ¥Ό μ„ μ–Έν•μ—¬, ν•΄λ‹Ή μ»΄ν¬λ„νΈλ¥Ό ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈλ΅ μ§€μ •ν•λ” λ°©λ²•μ…λ‹λ‹¤.

```ts
// TaskInfoPanel.tsx
"use client";

export default function TaskInfoPanel() {
  // useEffect, window λ“± λΈλΌμ°μ € μ „μ© API μ‚¬μ© κ°€λ¥
}
```

- `"use client"`λ¥Ό μ„ μ–Έν•λ©΄** ν•΄λ‹Ή νμΌμ€ μ„λ²„κ°€ μ•„λ‹ ν΄λΌμ΄μ–ΈνΈμ—μ„ λ λ”λ§λλ©°, λΈλΌμ°μ € μ „μ© APIλ¥Ό μ‚¬μ©ν•  μ μμµλ‹λ‹¤.**
- λ‹¤λ§ μ΄ λ°©μ‹μ€ μ»΄ν¬λ„νΈκ°€ μ—¬μ „ν νμ΄μ§€ **μ΄κΈ° λ²λ“¤μ— ν¬ν•¨λ  μ μκΈ° λ•λ¬Έμ—,
μ„±λ¥μƒ λ¬Έμ λ‚ μ΅°κ±΄λ¶€ λ λ”λ§μ΄ ν•„μ”ν• κ²½μ° `dynamic(..., { ssr: false })` λ°©μ‹μ΄ λ” μ μ ν•©λ‹λ‹¤.**

μ €λ” κ·Έλμ„ μ΄λ ‡κ² μ‚¬μ©ν–μµλ‹λ‹¤:

| μ»΄ν¬λ„νΈ       | μ΄μ  λ° μ‚¬μ©λ²•                                   |
| ------------- | --------------------------------------------- |
| KanbanBoard   | React ν›… μ‚¬μ© + ν•­μƒ λ λ”λ§ β†’ `"use client"` μ„ μ–Έ  |
| TaskInfoPanel | λ¬΄κ±°μ›€ + μ΅°κ±΄λ¶€ λ λ”λ§ + SSR μ¤λ¥ λ°©μ§€ β†’ `dynamic(..., { ssr: false })` |



## π¤” "use client"μ™€ ssr: falseμ μ°¨μ΄

| κµ¬λ¶„        | `"use client"`                       | `dynamic(..., { ssr: false })` |
| --------- | ------------------------------------ | ------------------------------ |
| μ„μΉ        | μ»΄ν¬λ„νΈ λ‚΄λ¶€ μƒλ‹¨                           | μ»΄ν¬λ„νΈλ¥Ό importν•λ” κ³³               |
| λ λ”λ§ μ‹μ     | ν΄λΌμ΄μ–ΈνΈμ—μ„ μ¦‰μ‹ λ λ”λ§                       | ν΄λΌμ΄μ–ΈνΈμ—μ„ μ§€μ—° λ΅λ”© (Lazy Load)      |
| μ„λ²„ λ λ”λ§ μ—¬λ¶€ | β (ν΄λΌμ΄μ–ΈνΈ μ „μ©)                         | β (ν΄λΌμ΄μ–ΈνΈ μ „μ©)                   |
| μ£Όμ” μ©λ„     | `useState`, `useEffect` λ“± ν΄λΌμ΄μ–ΈνΈ ν›… μ‚¬μ© | λ¬΄κ±°μ΄ μ»΄ν¬λ„νΈλ¥Ό μ΅°κ±΄λ¶€ λ λ”λ§ν•κ±°λ‚ SSR μ—λ¬ λ°©μ§€ |
| λ²λ“¤ ν¬ν•¨ μ—¬λ¶€  | ν¬ν•¨λ¨ (μ΄κΈ° λ΅λ”© μν–¥ μμ)                    | λ¶„λ¦¬λ¨ (μ„±λ¥ μµμ ν™” κ°€λ¥)                |

## π’΅ μ–Έμ  ssr: false λλ” "use client"λ¥Ό μ¨μ•Ό ν• κΉ?

| μ΅°κ±΄                                      | μ‚¬μ© κ¶μ¥ λ°©μ‹                       |
| --------------------------------------- | ------------------------------ |
| `window`, `document` λ“± λΈλΌμ°μ € κ°μ²΄λ¥Ό μ‚¬μ©ν•  λ•   | `ssr: false` λλ” `"use client"` |
| `useState`, `useEffect` κ°™μ€ React ν›…μ„ μ“Έ λ• | `"use client"`                 |
| μ΅°κ±΄λ¶€λ΅ λ λ”λ§λλ” λ¬΄κ±°μ΄ μ»΄ν¬λ„νΈ                     | `ssr: false` (μ„±λ¥ μµμ ν™”)          |
| SSRμ—μ„ μ—λ¬κ°€ λ°μƒν•  κ²½μ°                        | `ssr: false`                   |

## π§  κ°λ… μ •λ¦¬: SSR vs CSR

| κµ¬λ¶„     | SSR (Server-Side Rendering) | CSR (Client-Side Rendering) |
| ------ | --------------------------- | --------------------------- |
| μ •μ     | HTMLμ„ μ„λ²„μ—μ„ λ―Έλ¦¬ μƒμ„±            | HTMLμ„ ν΄λΌμ΄μ–ΈνΈμ—μ„ JSλ΅ μƒμ„±        |
| λ λ”λ§ μ„μΉ | μ„λ²„ (Node.js)                | λΈλΌμ°μ €                        |
| μ¥μ      | SEOμ— μ λ¦¬, λΉ λ¥Έ μ΄κΈ° λ λ”λ§          | λ™μ  UIμ— μ ν•©, μ„λ²„ λ¶€ν• μ μ         |
| λ‹¨μ      | μ„λ²„ λ¶€ν• μ¦κ°€, hydration μ΄μ κ°€λ¥   | μ΄κΈ° λ΅λ”© λλ¦Ό, SEO λ¶λ¦¬            |

Next.jsλ” κΈ°λ³Έμ μΌλ΅ SSRκ³Ό CSRμ„ νΌν•©ν•΄μ„ μ‚¬μ©ν•λ” Hybrid ν”„λ μ„μ›ν¬μ…λ‹λ‹¤.
μƒν™©μ— λ”°λΌ μ μ ν• μ „λµμ„ μ„ νƒν•λ” κ²ƒμ΄ μ¤‘μ”ν•©λ‹λ‹¤.

```text
   		μ»΄ν¬λ„νΈ λ λ”λ§ μ‹μ‘
         	 β”‚
        β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
    "use client" μ„ μ–Έ μ—¬λ¶€?
   β”β”€β”€β”€β”€β”€β”€β”€β”€β”΄β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
  Yes                    No
   β”‚                     β”‚
 ν΄λΌμ΄μ–ΈνΈ μ „μ©   μ„λ²„μ‚¬μ΄λ“ λ λ”λ§ λλ” μ •μ  μƒμ„±
  (CSR)                 (SSR or SSG)
   β”‚                     β”‚
λΈλΌμ°μ €μ—μ„ λ λ”λ§      μ„λ²„μ—μ„ λ―Έλ¦¬ μƒμ„±λ HTML μ κ³µ
```


## β οΈ μ£Όμ
- λ„λ¬΄ λ§μ€ μ»΄ν¬λ„νΈλ¥Ό `ssr: false`λ΅ μ²λ¦¬ν•λ©΄, μ΄κΈ° λ΅λ”© μ†λ„ μ €ν• λ° SEO λ¶μ΄μµμ΄ μƒκΈΈ μ μμµλ‹λ‹¤.
- SSRμ΄ λ¶κ°€λ¥ν•κ±°λ‚ ν΄λΌμ΄μ–ΈνΈμ—μ„λ§ λ λ”λ§ν•΄μ•Ό ν•λ” κ²½μ°μ—λ§ μ ν•μ μΌλ΅ μ‚¬μ©ν•΄μ•Ό ν•©λ‹λ‹¤.
- κ°€λ¥ν•λ‹¤λ©΄ ν΄λΌμ΄μ–ΈνΈ μ „μ© ν›…λ§ λ”°λ΅ λ¶„λ¦¬ν•λ” κ²ƒλ„ μΆ‹μ€ λ°©λ²•μ…λ‹λ‹¤.

## π“ κ²°λ΅ 
Next.jsμ—μ„ Hydration failed μ—λ¬κ°€ λ°μƒν–λ‹¤λ©΄:

- λΈλΌμ°μ € μ „μ© μ½”λ“λ¥Ό SSRλ΅ λ λ”λ§ν•μ§€ μ•λ„λ΅ κµ¬μ„±ν•΄μ•Ό ν•©λ‹λ‹¤.
- κ·Έ μ¤‘ ν•λ‚κ°€ dynamic(import, { ssr: false })λ¥Ό ν™μ©ν• ν΄λΌμ΄μ–ΈνΈ μ „μ© λ λ”λ§μ…λ‹λ‹¤.
- λ λ‹¤λ¥Έ λ°©λ²•μ€ "use client"λ¥Ό ν™μ©ν•΄ ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈλ¥Ό λ…μ‹ν•λ” κ²ƒμ…λ‹λ‹¤.

μƒν™©μ— λ”°λΌ μ΄ λ‘ κ°€μ§€ λ°©μ‹μ„ μ μ ν νΌν•©ν•λ©΄, μ•μ •μ μΈ λ λ”λ§μ΄ κ°€λ¥ν•©λ‹λ‹¤.