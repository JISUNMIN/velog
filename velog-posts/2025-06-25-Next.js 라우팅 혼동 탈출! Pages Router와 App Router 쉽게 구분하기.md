Next.js를 사용하다 보면 “Pages Router”와 “App Router”라는 두 가지 라우팅 방식을 만나게 됩니다.  
두 방식에 따라 라우팅 구조뿐만 아니라 사용할 수 있는 라우터 관련 훅(import) 도 다르기 때문에
헷갈리지 않도록 정리해보겠습니다. 

저는 **최신 구조인 App Router** 방식을 사용하고 있습니다.

---

## 1.🧱 Pages Router란?

### 개념

- Next.js가 오랫동안 사용해온 전통적인 라우팅 시스템입니다.  
- `pages/` 폴더 내 파일명이 URL 경로가 됩니다.  
- React 컴포넌트는 CSR, SSR, SSG 방식으로 렌더링됩니다.

### 특징

- **라우팅 방식**: 파일명 기반 라우팅  
- **데이터 패칭**: `getStaticProps`, `getServerSideProps`, `getStaticPaths` 함수 사용  
- **API 라우트**: `pages/api` 폴더 내 API 엔드포인트 구현  
- **렌더링**: 클라이언트 + 서버 혼합 렌더링  
- **레이아웃 관리**: `_app.js`에서 공통 레이아웃 관리  


### 1. 파일명 기반 라우팅 (Pages Router)

**파일명 기반 라우팅**은 Next.js가 전통적으로 사용해온 방식입니다.  
`pages/` 폴더 안에 있는 파일 이름이 그대로 URL 경로가 됩니다.

#### 예시
```
pages/
├── index.js → / (홈페이지)
├── about.js → /about (소개 페이지)
├── blog.js → /blog (블로그 목록 페이지)
└── blog/
└── [id].js → /blog/:id (동적 라우팅 - 블로그 상세 페이지)
```

### 2. Pages Router에서의 API 라우트

- `pages/api` 폴더 내에 파일을 만들면 그 파일이 API 엔드포인트가 됩니다.  
- 파일명과 경로가 API 경로와 일치합니다.

#### 예시: `pages/api/hello.js`

```js
export default function handler(req, res) {
  if (req.method === 'GET') {
    res.status(200).json({ message: 'GET 요청 처리' });
  } else if (req.method === 'POST') {
    res.status(201).json({ message: 'POST 요청 처리' });
  } else {
    res.status(405).end(); // 허용되지 않는 메서드
  }
}
```
단일 함수 handler를 export하는 형태입니다.

### 3. Pages Router에서의 데이터 패칭

- 데이터 패칭을 위해 **`getStaticProps`**, **`getServerSideProps`**, **`getStaticPaths`** 같은 특별한 함수를 사용해야 합니다.  
- 이 함수들은 페이지 컴포넌트와 별도로 작성되며, Next.js가 빌드 시 혹은 요청 시 호출해 데이터를 받아 페이지에 전달합니다.

| 함수명               | 역할                                      |
|--------------------|-----------------------------------------|
| `getStaticProps`    | 빌드 시점에 데이터를 미리 가져와 정적 생성(SSG)        |
| `getServerSideProps`| 요청 시마다 서버에서 데이터를 가져와 서버 사이드 렌더링(SSR) |
| `getStaticPaths`    | 동적 경로 생성 시 미리 렌더링할 경로 목록 생성            |

#### 예시

```js
export async function getStaticProps() {
  const res = await fetch('https://api.example.com/data');
  const data = await res.json();
  return {
    props: { data },
  };
}

function Page({ data }) {
  return <div>{data.title}</div>;
}

export default Page;
```

---

## 2.✨ App Router란?
**(최신 - Next.js 13이후 도입)**

### 개념

- Next.js 13에서 새롭게 도입된 라우팅 시스템  
- `app/` 폴더 기반 라우팅으로, React 18의 **서버 컴포넌트(Server Components)**를 기본 지원합니다.  
- 레이아웃, 템플릿, 중첩 라우팅 등 구조화된 설계가 가능합니다.

### 특징

- **라우팅 방식**: 폴더 구조 기반 라우팅 + 파일 기반 라우팅  
- **서버 컴포넌트 기본 사용**: 서버에서 렌더링하는 컴포넌트를 기본으로 사용하고 필요 시 클라이언트 컴포넌트 지정  
- **데이터 패칭**: React 컴포넌트 내에서 `fetch` API를 직접 호출해 서버 데이터 가져오기 가능 (따로 함수 분리 불필요)  
- **API 라우트**: `app/api` 폴더 내에서 Route Handlers로 구현 (파일 기반 API 라우팅)  
- **중첩 레이아웃(Nested Layouts)**: 경로별로 부분적인 레이아웃 재사용 및 중첩이 가능  
- **점진적 채택 가능**: 기존 `pages` 폴더와 함께 혼용 가능

---

### 1. 폴더 구조 + 파일 기반 라우팅 (App Router)  
Next.js 13부터 도입된 새로운 라우팅 방식입니다.  
`app/` 폴더 내에서 **폴더 이름과 파일 이름이 합쳐져 URL 경로를 만듭니다.**

#### 예시
```
app/
├── page.js → / (홈페이지)
├── about/
│ └── page.js → /about (소개 페이지)
├── blog/
│ ├── page.js → /blog (블로그 목록 페이지)
│ └── [id]/
│ └── page.js → /blog/:id (동적 라우팅 - 블로그 상세 페이지)
```


### 2. Route Handlers라는 파일 기반 API 라우팅
HTTP 메서드별로 파일을 나누거나 한 파일에서 메서드를 export하는 방식입니다.

#### 예시: `app/api/hello/route.js`

```js
// app/api/hello/route.js
export async function GET(request) {
  return new Response(JSON.stringify({ message: 'Hello from App Router API!' }), {
    status: 200,
    headers: { 'Content-Type': 'application/json' },
  });
}
export async function POST(request) {
  const data = await request.json();
  return new Response(JSON.stringify({ received: data }), {
    status: 201,
    headers: { 'Content-Type': 'application/json' },
  });
}
```

### 3. 별도의 데이터 패칭 함수가 없음
별도의 데이터 패칭 함수가 없습니다.
React 서버 컴포넌트 내에서 fetch API를 직접 호출해 서버 데이터를 가져옵니다.
이 방식은 코드가 한 곳에 모여서 더 직관적이고 간결합니다.

```jsx
// app/page.js (React 서버 컴포넌트)
export default async function Page() {
  const res = await fetch('https://api.example.com/data');
  const data = await res.json();
  return <div>{data.title}</div>;
}
```

### 4. 중첩 레이아웃 (Nested Layouts)  
중첩 레이아웃은 페이지들의 공통 레이아웃을 **중첩하여 재사용**하는 기능입니다.  
App Router의 강력한 특징 중 하나입니다.

### ❓왜 필요할까?
- 모든 페이지에 공통으로 들어가는 헤더, 푸터  
- 특정 섹션(예: 블로그)에서만 공통으로 들어가는 사이드바 등  
- 이런 공통 요소를 반복해서 작성하지 않고 한 번만 정의하여 재사용

#### 예시
```
app/
├── layout.js → 모든 페이지에 적용되는 최상위 레이아웃 (헤더, 푸터 포함)
├── about/
│ └── page.js → /about 페이지
├── blog/
│ ├── layout.js → 블로그 섹션에만 적용되는 레이아웃 (예: 사이드바 포함)
│ ├── page.js → /blog 페이지
│ └── [id]/
│ └── page.js → /blog/:id 페이지
```


---

## ✅ 주요 차이점 비교

| 구분                   |🧱 Pages Router (`pages/`)          | ✨ App Router (`app/`)                         |
|----------------------|------------------------------|------------------------------------------|
| 폴더 위치               | `pages/`                      | `app/`                                   |
| 라우팅 방식             | 파일 기반 라우팅                 | 폴더 + 파일 기반 라우팅                      |
| 데이터 패칭 방식         | `getStaticProps`, `getServerSideProps` 함수 사용 | React 서버 컴포넌트 내부에서 직접 fetch 가능   |
| 렌더링 방식             | 클라이언트+서버 혼합 렌더링         | 서버 컴포넌트 기본, 클라이언트 컴포넌트 선택적 지정 |
| API 라우트 위치          | `pages/api`                    | `app/api` (Route Handlers)                 |
| 레이아웃 관리            | `_app.js`에서 전역 레이아웃 관리       | 중첩 레이아웃 지원, 부분별 레이아웃 관리 가능          |
| 중첩 라우팅              | 제한적                        | 강력한 중첩 라우팅 지원                       |
| 쿼리 파라미터 읽기        | `useRouter().query`             | `useSearchParams()` 훅 사용                   |
| React 18 서버 컴포넌트 지원 | 지원하지 않음                   | 기본 지원                                  |
| 마이그레이션 난이도        | 기존 프로젝트에 적합               | 새 프로젝트나 점진적 도입 권장                   |

---

## ❓ 언제 어떤 라우터를 써야 할까?

| 상황                       | 권장 라우터          | 이유                                   |
|--------------------------|-------------------|--------------------------------------|
| 기존 Next.js 프로젝트 유지보수    | Pages Router       | 기존 구조 유지, 변경 최소화                    |
| 최신 React 기능 활용 및 새 프로젝트 | App Router         | 서버 컴포넌트, 중첩 레이아웃, 간편한 데이터 패칭 가능    |
| 점진적 기능 도입              | 혼용 가능 (App Router 일부 도입) | 점진적 마이그레이션 가능                      |


---

## 📝 마무리

Next.js는 앞으로 **App Router**를 중심으로 발전해 나가고 있으며,  
**서버 컴포넌트(Server Components)**와 **중첩 레이아웃(Nested Layouts)** 등 강력한 기능을 제공합니다.

하지만 여전히 많은 프로젝트에서 기존 **Pages Router**를 사용하고 있으므로, 상황에 맞게 사용하시면 될 것 같습니다.
다만, 각 라우터에 따라 사용할 수 있는 `router` 관련 훅(import)이 다르기 때문에,  
**어떤 라우터를 사용하는지 정확히 알고 구분하여 사용하는 것이 필요합니다.**

| 사용 환경             | 사용 가능한 라우터 훅                     |
|----------------------|------------------------------------------|
| **Pages Router**     | `import { useRouter } from 'next/router'` |
| **App Router**       | `import { useRouter } from 'next/navigation'` |

👉  다음 장에서는 **Pages Router**와 **App Router**의 라우터 훅을  
**차이점을 중심으로 정리해보겠습니다.**

### 🔗 참고 링크

- [Next.js 공식 Docs - Pages Router](https://nextjs.org/docs/pages/getting-started)
- [Next.js 공식 Docs - App Router](https://nextjs.org/docs/app/getting-started)

